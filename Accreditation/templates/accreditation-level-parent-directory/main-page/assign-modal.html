{% load crispy_forms_tags %}

 <!-- Modal -->
	<div class="modal modal-blur fade" id="assign-modal-{{ record.id }}" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
		<div id='create-modal-dialog' class="modal-dialog modal-lg">
			<div class="modal-content">

				<div class="modal-header">
					<h1 class="modal-title">Add instrument's accreditation level</h1>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>

				<div class="modal-body">

					<!-- PROGRESS BAR-->
					<div class="progress px-1" style="height: 3px;">
						<div class="progress-bar" id="form-progress-bar-{{ record.id }}" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
					</div>
					<div class="step-container d-flex justify-content-between">
						<div class="step-circle" onclick="displayStep{{ record.id }}(1)">1</div>
						<div class="step-circle" onclick="displayStep{{ record.id }}(2)">2</div>
						<div class="step-circle" onclick="displayStep{{ record.id }}(3)">3</div>
						<div class="step-circle" onclick="displayStep{{ record.id }}(4)">4</div>
					</div>
					
					<form id="assign-form-{{ record.id }}">
						{% csrf_token %}
						<div class="step{{ record.id }} step{{ record.id }}-1">
							<!-- Step 1 form fields here -->
							<h3>Step 1: Add Area Chairman</h3>
								<input type="hidden" name="parent_directory" value={{ record.id }}>
								{% include "accreditation-level-parent-directory/main-page/folder-chairman-table.html" %}
							<br>
							<button type="button" class="btn btn-primary next-step-{{ record.id }}">Next</button>
						</div>
					
						<div class="step{{ record.id }} step{{ record.id }}-2">
							<div class="row align-items-center">
								<div class="col">
									<!-- Step 2 form fields here -->
									<h3>Step 2: Add Co-chairman</h3>
								</div>
							</div>
								{% include "accreditation-level-parent-directory/main-page/folder-cochairman-table.html" %}
							<br>
							<button type="button" class="btn btn-primary prev-step-{{ record.id }}">Previous</button>
							<button type="button" class="btn btn-primary next-step-{{ record.id }}">Next</button>
						</div>

						<div class="step{{ record.id }} step{{ record.id }}-3">
							<div class="row align-items-center">
								<div class="col">
									<!-- Step 3 form fields here -->
									<h3>Step 3: Add Area Members</h3>
								</div>
							</div>
								{% include "accreditation-level-parent-directory/main-page/folder-members-table.html" %}
							<br>
							<button type="button" class="btn btn-primary prev-step-{{ record.id }}">Previous</button>
							<button type="button" class="btn btn-primary next-step-{{ record.id }}">Next</button>
						</div>
					
						<div class="step{{ record.id }} step{{ record.id }}-4">
							<!-- Step 3 form fields here -->
							<h3>Step 4: Complete the Area Assignment</h3>
							<div class="mb-3">
								<p>Please click the Submit button if the member assignment to area is done. </p>
							</div>
							<button type="button" class="btn btn-primary prev-step-{{ record.id }}">Previous</button>
							<button type="button" data-id={{ record.id }} class="btn btn-primary assign-button">Submit</button>
						</div>
					</form>
				</div>
			</div>
		</div>
	</div> 
<script>
    var currentStep{{ record.id }} = 1;
    var updateProgressBar{{ record.id }};
    
      function displayStep{{ record.id }}(stepNumber{{ record.id }}) {
        if (stepNumber{{ record.id }} >= 1 && stepNumber{{ record.id }} <= 4) {
          $(".step{{ record.id }}-" + currentStep{{ record.id }}).hide();
          $(".step{{ record.id }}-" + stepNumber{{ record.id }}).show();
          currentStep{{ record.id }} = stepNumber{{ record.id }};
          updateProgressBar{{ record.id }}();
        }
      }
    
      $(document).ready(function() {
        $('#assign-form-{{ record.id }}').find('.step{{ record.id }}').slice(1).hide();
      
        $(".next-step-{{ record.id }}").click(function() {
          if (currentStep{{ record.id }} < 4) {
            $(".step{{ record.id }}-" + currentStep{{ record.id }}).addClass("animate__animated animate__fadeOutLeft");
            currentStep{{ record.id }}++;
            setTimeout(function() {
              $(".step{{ record.id }}").removeClass("animate__animated animate__fadeOutLeft").hide();
              $(".step{{ record.id }}-" + currentStep{{ record.id }}).show().addClass("animate__animated animate__fadeInRight");
              updateProgressBar{{ record.id }}();
            }, 500);
          }
        });
    
        $(".prev-step-{{ record.id }}").click(function() {
          if (currentStep{{ record.id }} > 1) {
            $(".step{{ record.id }}-" + currentStep{{ record.id }}).addClass("animate__animated animate__fadeOutRight");
            currentStep{{ record.id }}--;
            setTimeout(function() {
              $(".step{{ record.id }}").removeClass("animate__animated animate__fadeOutRight").hide();
              $(".step{{ record.id }}-" + currentStep{{ record.id }}).show().addClass("animate__animated animate__fadeInLeft");
              updateProgressBar{{ record.id }}();
            }, 500);
          }
        });
    
        updateProgressBar{{ record.id }} = function() {
          var progressPercentage{{ record.id }} = ((currentStep{{ record.id }} - 1) / 3) * 100;
          $("#form-progress-bar-{{ record.id }}").css("width", progressPercentage{{ record.id }} + "%");
        }
      });
</script>

<script>
    // Function to check all checkboxes on ASSIGN
    $(document).ready(function() {
        // Check
        $("#check-all-assign-{{record.id}}").on("click", function() {
            if ($(this).prop("checked")) {
                $(".check-button-{{record.id}}").prop("checked", true); // Use your checkbox ID here
            } else {
                $(".check-button-{{record.id}}").prop("checked", false); // Use your checkbox ID here
            }
        });

        // Uncheck
        $(".check-button-{{record.id}}").on("change", function() { // Use your checkbox ID here
            if (!$(this).prop("checked")) {
                $("#check-all-assign").prop("checked", false);
            }

        });
    });
</script>